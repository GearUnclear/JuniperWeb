<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit Lookup Program</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /* Google-like minimalist design */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f1f1f1;
        }
        #search-form {
            text-align: center;
            margin-top: 15%;
        }
        #unit_number {
            width: 50%;
            padding: 12px 20px;
            margin: 8px 0;
            box-sizing: border-box;
            border: 2px solid #ccc;
            border-radius: 4px;
        }
        input[type=submit] {
            background-color: #4285f4;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        input[type=submit]:hover {
            background-color: #357ae8;
        }
        #result {
            margin: 20px;
            padding: 20px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <form id="search-form">
        <label for="unit_number"></label>
        <input type="text" id="unit_number" name="unit_number" placeholder="Enter Unit Number">
        <br>
        <input type="submit" value="Search">
    </form>

    <div id="result"></div>

<script>
    $(document).ready(function(){
        $("#search-form").submit(function(event){
            event.preventDefault();
            var unitNumber = $("#unit_number").val();

            // Debugging: Log the submitted unit number
            console.log("Submitted unit_number:", unitNumber);

            $.post("/search", { unit_number: unitNumber }, function(data, status){

                // Debugging: Log the received data and status
                console.log("Received data:", data);
                console.log("Status:", status);

                if (status === "success") {
                    if (data.error) {
                        $("#result").html("<p>Error: " + data.error + "</p>");
                    } else {
                        // Assuming the data is a list of objects where each object is a row from the DataFrame
                        var htmlContent = "<table><tr>";
                        for (var key in data[0]) {
                            htmlContent += "<th>" + key + "</th>";
                        }
                        htmlContent += "</tr>";
                        for (var i = 0; i < data.length; i++) {
                            htmlContent += "<tr>";
                            for (var key in data[i]) {
                                htmlContent += "<td>" + data[i][key] + "</td>";
                            }
                            htmlContent += "</tr>";
                        }
                        htmlContent += "</table>";
                        $("#result").html(htmlContent);
                    }
                } else {
                    $("#result").html("<p>Error occurred while fetching data.</p>");
                }
            }).fail(function(jqXHR, textStatus, errorThrown) {
                // Debugging: Log additional error details
                console.log("AJAX request failed");
                console.log("Status: " + textStatus);
                console.log("Error: " + errorThrown);
            });
        });
    });
</script>

</body>
</html>
